<template>
  <Popover class="relative">
    <PopoverButton
      class="hidden md:flex rounded-md px-3 py-5 w-auto  text-center text-sm font-semibold h-10 items-center justify-center mx-2  text-gray-900 bg-white border-0 ring-1 ring-inset ring-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-[1px] focus:ring-inset focus:ring-gray-300"
    >
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-2 text-gray-400">
        <path fill-rule="evenodd" d="M11.828 2.25c-.916 0-1.699.663-1.85 1.567l-.091.549a.798.798 0 0 1-.517.608 7.45 7.45 0 0 0-.478.198.798.798 0 0 1-.796-.064l-.453-.324a1.875 1.875 0 0 0-2.416.2l-.243.243a1.875 1.875 0 0 0-.2 2.416l.324.453a.798.798 0 0 1 .064.796 7.448 7.448 0 0 0-.198.478.798.798 0 0 1-.608.517l-.55.092a1.875 1.875 0 0 0-1.566 1.849v.344c0 .916.663 1.699 1.567 1.85l.549.091c.281.047.508.25.608.517.06.162.127.321.198.478a.798.798 0 0 1-.064.796l-.324.453a1.875 1.875 0 0 0 .2 2.416l.243.243c.648.648 1.67.733 2.416.2l.453-.324a.798.798 0 0 1 .796-.064c.157.071.316.137.478.198.267.1.47.327.517.608l.092.55c.15.903.932 1.566 1.849 1.566h.344c.916 0 1.699-.663 1.85-1.567l.091-.549a.798.798 0 0 1 .517-.608 7.52 7.52 0 0 0 .478-.198.798.798 0 0 1 .796.064l.453.324a1.875 1.875 0 0 0 2.416-.2l.243-.243c.648-.648.733-1.67.2-2.416l-.324-.453a.798.798 0 0 1-.064-.796c.071-.157.137-.316.198-.478.1-.267.327-.47.608-.517l.55-.091a1.875 1.875 0 0 0 1.566-1.85v-.344c0-.916-.663-1.699-1.567-1.85l-.549-.091a.798.798 0 0 1-.608-.517 7.507 7.507 0 0 0-.198-.478.798.798 0 0 1 .064-.796l.324-.453a1.875 1.875 0 0 0-.2-2.416l-.243-.243a1.875 1.875 0 0 0-2.416-.2l-.453.324a.798.798 0 0 1-.796.064 7.462 7.462 0 0 0-.478-.198.798.798 0 0 1-.517-.608l-.091-.55a1.875 1.875 0 0 0-1.85-1.566h-.344ZM12 15.75a3.75 3.75 0 1 0 0-7.5 3.75 3.75 0 0 0 0 7.5Z" clip-rule="evenodd"/>
      </svg>
      <span class="text-gray-400">{{ title }}</span>
    </PopoverButton>
    <transition enter-active-class="transition ease-out duration-200" enter-from-class="opacity-0 translate-y-1" enter-to-class="opacity-100 translate-y-0" leave-active-class="transition ease-in duration-150" leave-from-class="opacity-100 translate-y-0" leave-to-class="opacity-0 translate-y-1">
      <PopoverPanel class="absolute left-11 z-10 mt-0 flex w-screen max-w-min -translate-x-1/2 px-4">
        <div class="w-64 shrink rounded-md bg-white p-4 text-sm leading-6 text-gray-900 shadow-lg ring-1 ring-gray-900/5">
          <draggable :list="columns" item-key="field">
            <template #item="{ element }" class="cursor-pointer">
              <div class="flex flex-row items-center relative justify-between my-1 bg-white py-0.5 px-0.5 rounded-md" :key="element.field">
                <div class="flex flex-row items-center">
                  <input type="checkbox" class="h-4 w-4 mr-2 rounded border-gray-300 text-primary-red focus:ring-white"  :checked="element.visible" @change="toggleColumnVisibility(element.field)" />
                  <p :class="{ 'text-gray-500 text-thin': !element.visible }">{{ element.header }}</p>
                </div>
                <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path class="w-4 h-4 ml-2 cursor-pointer" d="M3.2381 1.61905C3.2381 1.93927 3.14314 2.25229 2.96524 2.51854C2.78733 2.78479 2.53447 2.99231 2.23863 3.11485C1.94279 3.2374 1.61725 3.26946 1.30319 3.20699C0.989123 3.14452 0.700637 2.99032 0.474209 2.76389C0.247781 2.53746 0.0935816 2.24897 0.0311103 1.93491C-0.031361 1.62084 0.000701503 1.29531 0.123243 0.999466C0.245785 0.703623 0.453303 0.450763 0.719554 0.27286C0.985805 0.0949565 1.29883 8.72496e-07 1.61905 8.72496e-07C2.04845 8.72496e-07 2.46026 0.170579 2.76389 0.474209C3.06752 0.777839 3.2381 1.18965 3.2381 1.61905ZM8.5 8.72496e-07C8.17978 8.72496e-07 7.86676 0.0949565 7.60051 0.27286C7.33425 0.450763 7.12674 0.703623 7.0042 0.999466C6.88165 1.29531 6.84959 1.62084 6.91206 1.93491C6.97453 2.24897 7.12873 2.53746 7.35516 2.76389C7.58159 2.99032 7.87008 3.14452 8.18414 3.20699C8.4982 3.26946 8.82374 3.2374 9.11958 3.11485C9.41543 2.99231 9.66829 2.78479 9.84619 2.51854C10.0241 2.25229 10.119 1.93927 10.119 1.61905C10.119 1.18965 9.94847 0.777839 9.64484 0.474209C9.34121 0.170579 8.9294 8.72496e-07 8.5 8.72496e-07ZM15.381 3.2381C15.7012 3.2381 16.0142 3.14314 16.2804 2.96524C16.5467 2.78733 16.7542 2.53447 16.8768 2.23863C16.9993 1.94279 17.0314 1.61725 16.9689 1.30319C16.9064 0.989123 16.7522 0.700637 16.5258 0.474209C16.2994 0.247781 16.0109 0.0935816 15.6968 0.0311103C15.3827 -0.031361 15.0572 0.000701503 14.7614 0.123243C14.4655 0.245785 14.2127 0.453303 14.0348 0.719554C13.8569 0.985805 13.7619 1.29883 13.7619 1.61905C13.7619 2.04845 13.9325 2.46026 14.2361 2.76389C14.5397 3.06752 14.9516 3.2381 15.381 3.2381ZM1.61905 6.88095C1.29883 6.88095 0.985805 6.97591 0.719554 7.15381C0.453303 7.33171 0.245785 7.58458 0.123243 7.88042C0.000701503 8.17626 -0.031361 8.5018 0.0311103 8.81586C0.0935816 9.12993 0.247781 9.41841 0.474209 9.64484C0.700637 9.87127 0.989123 10.0255 1.30319 10.0879C1.61725 10.1504 1.94279 10.1183 2.23863 9.99581C2.53447 9.87326 2.78733 9.66575 2.96524 9.3995C3.14314 9.13324 3.2381 8.82022 3.2381 8.5C3.2381 8.0706 3.06752 7.65879 2.76389 7.35516C2.46026 7.05153 2.04845 6.88095 1.61905 6.88095ZM8.5 6.88095C8.17978 6.88095 7.86676 6.97591 7.60051 7.15381C7.33425 7.33171 7.12674 7.58458 7.0042 7.88042C6.88165 8.17626 6.84959 8.5018 6.91206 8.81586C6.97453 9.12993 7.12873 9.41841 7.35516 9.64484C7.58159 9.87127 7.87008 10.0255 8.18414 10.0879C8.4982 10.1504 8.82374 10.1183 9.11958 9.99581C9.41543 9.87326 9.66829 9.66575 9.84619 9.3995C10.0241 9.13324 10.119 8.82022 10.119 8.5C10.119 8.0706 9.94847 7.65879 9.64484 7.35516C9.34121 7.05153 8.9294 6.88095 8.5 6.88095ZM15.381 6.88095C15.0607 6.88095 14.7477 6.97591 14.4815 7.15381C14.2152 7.33171 14.0077 7.58458 13.8851 7.88042C13.7626 8.17626 13.7305 8.5018 13.793 8.81586C13.8555 9.12993 14.0097 9.41841 14.2361 9.64484C14.4625 9.87127 14.751 10.0255 15.0651 10.0879C15.3792 10.1504 15.7047 10.1183 16.0005 9.99581C16.2964 9.87326 16.5492 9.66575 16.7271 9.3995C16.905 9.13324 17 8.82022 17 8.5C17 8.0706 16.8294 7.65879 16.5258 7.35516C16.2222 7.05153 15.8104 6.88095 15.381 6.88095ZM1.61905 13.7619C1.29883 13.7619 0.985805 13.8569 0.719554 14.0348C0.453303 14.2127 0.245785 14.4655 0.123243 14.7614C0.000701503 15.0572 -0.031361 15.3827 0.0311103 15.6968C0.0935816 16.0109 0.247781 16.2994 0.474209 16.5258C0.700637 16.7522 0.989123 16.9064 1.30319 16.9689C1.61725 17.0314 1.94279 16.9993 2.23863 16.8768C2.53447 16.7542 2.78733 16.5467 2.96524 16.2804C3.14314 16.0142 3.2381 15.7012 3.2381 15.381C3.2381 14.9516 3.06752 14.5397 2.76389 14.2361C2.46026 13.9325 2.04845 13.7619 1.61905 13.7619ZM8.5 13.7619C8.17978 13.7619 7.86676 13.8569 7.60051 14.0348C7.33425 14.2127 7.12674 14.4655 7.0042 14.7614C6.88165 15.0572 6.84959 15.3827 6.91206 15.6968C6.97453 16.0109 7.12873 16.2994 7.35516 16.5258C7.58159 16.7522 7.87008 16.9064 8.18414 16.9689C8.4982 17.0314 8.82374 16.9993 9.11958 16.8768C9.41543 16.7542 9.66829 16.5467 9.84619 16.2804C10.0241 16.0142 10.119 15.7012 10.119 15.381C10.119 14.9516 9.94847 14.5397 9.64484 14.2361C9.34121 13.9325 8.9294 13.7619 8.5 13.7619ZM15.381 13.7619C15.0607 13.7619 14.7477 13.8569 14.4815 14.0348C14.2152 14.2127 14.0077 14.4655 13.8851 14.7614C13.7626 15.0572 13.7305 15.3827 13.793 15.6968C13.8555 16.0109 14.0097 16.2994 14.2361 16.5258C14.4625 16.7522 14.751 16.9064 15.0651 16.9689C15.3792 17.0314 15.7047 16.9993 16.0005 16.8768C16.2964 16.7542 16.5492 16.5467 16.7271 16.2804C16.905 16.0142 17 15.7012 17 15.381C17 14.9516 16.8294 14.5397 16.5258 14.2361C16.2222 13.9325 15.8104 13.7619 15.381 13.7619Z" fill="black"/>
                </svg>
              </div>
            </template>
          </draggable>
        </div>
      </PopoverPanel>
    </transition>
  </Popover>
</template>

<script setup>
import { ref, defineProps, defineEmits } from 'vue';
import { Popover, PopoverButton, PopoverPanel } from "@headlessui/vue";
import draggable from 'vuedraggable';

const props = defineProps({
  columns: Array,
});

const emit = defineEmits(['toggle-column-visibility', 'update-items-order']);

const title = 'Column settings';

function toggleColumnVisibility(key) {
  emit('toggle-column-visibility', key);
}
</script>

<style scoped>
/* Add any scoped styles here */
</style>
